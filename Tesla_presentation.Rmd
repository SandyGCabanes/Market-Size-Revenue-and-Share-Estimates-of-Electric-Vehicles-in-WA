---
title: "Washington EV Market Breakdown: Tesla’s Share, Pricing, and Trends"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: scroll
    theme: cosmo
    toc: true
---

### Executive Summary

```         
This dashboard analyzes Tesla’s performance in Washington State’s electric vehicle market using real-world registration data. 
It explores market share, model-level sales, estimated revenue, pricing comparisons, and utility partnerships. 
The project demonstrates skills in data wrangling, proactive research of missing MSRP data,
and business-focused visualization using R and Flexdashboard.

A major challenge was the absence of MSRP values for 99% of the vehicle records in the source dataset 
(https://catalog.data.gov/dataset/electric-vehicle-population-data). 
To address this, I conducted manual and batch research to enrich the dataset with accurate MSRP values by make and model. 
This step resulted in more realistic revenue estimation and competitive analysis.

**Key questions addressed:**

- What is Tesla’s market share in WA compared to other EV brands?
- Which Tesla models are most popular, and what is their estimated revenue impact?
- How do Tesla’s vehicle ranges and prices compare to competitors?
- How are PHEV and BEV trending?
- Which utilities are most commonly associated with Tesla EV registrations?

This project showcases reproducible analysis and clear communication of business-relevant 
metrics—skills essential for data analyst roles.
```

### Electric Vehicles All Time Market Share in WA (By Number of Cars Registered)

```{r Market Share Donut Chart}


library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)
library(scales)


dfcln <- read.csv("C:/Users/sandy/zportfolio_projects_128gbsdcard/2025_grouped/electric_vehicles/data_csv_files/df.csv")


dfwa <- dfcln %>% filter(State == "WA")

dfwa <- dfwa %>% mutate(Tesla.Vs.Others = case_when(
  Make == "TESLA" ~ "TESLA",
  TRUE ~ "OTHERS")
)

tesladf <- dfwa %>% filter(Make == "TESLA")
tesla_market_share <- nrow(tesladf) / nrow(dfwa) * 100
tesla_market_share <- round(tesla_market_share, digits = 1)


holesize <- 2
dfmarket<- data.frame(
  Group = c("Tesla", "Other"),
  Market_Share = c(tesla_market_share, 100-tesla_market_share)) %>%
  mutate(x = holesize)


donut_chart <- ggplot(dfmarket, aes(x = x, y = Market_Share, fill = Group)) +
  geom_col(width = 1, color = "white") +
  coord_polar(theta = "y") +
  xlim(c(0.2, holesize +0.5 )) +
  theme_void() +
  labs(title = "Electric Vehicles All Time Market Share in WA")+
  geom_text(aes(label = paste0(Market_Share, "%")), position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Tesla" = "#E82127", "Other" = "#999999"))

donut_chart

```

### Top Tesla Models Sold - All Time

```{r Bar Chart Top Tesla Models Sold}

teslatop <- tesladf %>% group_by(Make, Model) %>% summarize(count = n(), .groups = "drop") %>% arrange(desc(count))

barchart_topmodels <- ggplot(teslatop, aes(x=reorder(Model, count), y = count)) +
  geom_col(fill = "#E82127") +
  coord_flip() +
  labs(title = "Tesla Models Sold - All Time", x = NULL) +
  theme_minimal()
barchart_topmodels

```

### Top Tesla Models Estimated Revenue (All Time)

```{r Bar Chart Top Models Estimated Revenue}

msrp_lookup <- data.frame(
  Make = c("TESLA", "TESLA", "TESLA", "TESLA", "TESLA", "TESLA"),
  Model    = c("MODEL Y", "MODEL 3", "MODEL S", "MODEL X", "CYBERTRUCK", "ROADSTER"),
  AvgMSRP = c(50810, 48740, 87490, 92490, 84990, 225000),
  MinMSRP  = c(46630, 42490, 79990, 84990, 69990, 200000),
  MaxMSRP  = c(54990, 54990, 94990, 99990, 99990, 250000),
  stringsAsFactors = FALSE
)

teslatopwprice <- teslatop %>%
  left_join(msrp_lookup, by = "Model")

teslatopwprice <- teslatopwprice %>%
  mutate(
    AvgRevenue = count * AvgMSRP,
    MinRevenue = count * MinMSRP,
    MaxRevenue = count * MaxMSRP
  )


barchart_topmodels_avgrevenues <- ggplot(teslatopwprice, aes(x=reorder(Model, AvgRevenue), y = AvgRevenue)) +
  geom_col(fill = "#999999") +
  coord_flip() +
  labs(title = "Top Tesla Models Estimated Revenues - All Time", x = NULL, y = NULL) +
  scale_y_continuous(labels = label_comma()) +
  theme_minimal()
barchart_topmodels_avgrevenues

```

### Tesla Electric Vehicles Sold By Year (As of mid July 2025)

```{r Line Chart Tesla Sales By Year}
df_tesla_sold_by_year <- dfwa %>%
  filter(Tesla.Vs.Others == "TESLA") %>%
  group_by(Model.Year) %>%
  summarise(Count = n()) %>%
  arrange(Model.Year)


linechart_tesla_by_year <- ggplot(df_tesla_sold_by_year, aes(x = Model.Year, y = Count)) +
  geom_line(color = "#999999", size = 1) +
  geom_point(color = "#E82127", size = 2) +
  labs(title = "Tesla Electric Vehicles Sold By Year\n As of mid July 2025\n 2023 spike due to new tax credits in Jan 2023", y = NULL) +
  theme_minimal()
linechart_tesla_by_year

```

### Average Prices for Battery Electric Vehicles

```{r  Bar Chart MSRP for BEV}
msrp_csv <- read_delim(
  "C:/Users/sandy/zportfolio_projects_128gbsdcard/2025_grouped/electric_vehicles/data_csv_files/msrp_compiled.csv",
  delim = "|",
  escape_double = FALSE,
  trim_ws = TRUE
)

msrp_csv <- msrp_csv %>%
  slice(-1) %>%
  select(Make, Model, MinMSRP, MaxMSRP, `Price Year`) %>%
  mutate(
    MinMSRP = as.numeric(MinMSRP),
    MaxMSRP = as.numeric(MaxMSRP),
    AvgMSRP = round((MinMSRP + MaxMSRP) / 2, 0)
  )
         
dfclnfil <- inner_join(dfwa, msrp_csv, by = c("Make", "Model"))

dfteslavothers <- dfclnfil %>% group_by(Tesla.Vs.Others) %>%
 summarise(AvgMSRP = mean(AvgMSRP), MedianMSRP = median(AvgMSRP))

barchart_msrps <- ggplot(dfteslavothers, aes(x = Tesla.Vs.Others, y = AvgMSRP, fill = Tesla.Vs.Others)) +
  geom_col() +
  scale_fill_manual(values = c("TESLA" = "#E82127", "OTHERS" = "#999999")) +
  labs(title = "Average Prices for Battery Electric Vehicles", x = NULL, y = "Average Prices USD") +
  theme_minimal()
barchart_msrps
```

### Average Ranges for Battery Electric Vehicles

```{r Bar Chart Ranges for BEV}

dfevs <- dfclnfil %>% filter(Electric.Vehicle.Type == "Battery Electric Vehicle (BEV)" & Electric.Range != 0)
dfevsranges <- dfevs %>% group_by(Tesla.Vs.Others) %>%
  summarise(AvgRange = mean(Electric.Range), MedianRange= median(Electric.Range))


write.csv(dfevsranges, "tesla_others_ranges.csv")

barchart_ranges <- ggplot(dfevsranges, aes(x = Tesla.Vs.Others, y = AvgRange, fill = Tesla.Vs.Others)) +
  geom_col() +
  scale_fill_manual(values = c("TESLA" = "#E82127", "OTHERS" = "#999999")) +
  labs(title = "Tesla Higher Average Range vs. Others for Battery Electric Vehicles", x = NULL, y = "Average Range (miles)") +
  theme_minimal()
barchart_ranges
```

### PHEV vs. BEV Trends By Year

```{r  PHEV vs BEV Trends By Year}
df_evtrends <- dfclnfil %>%
  group_by(Model.Year, Electric.Vehicle.Type)  %>%
  summarise(Count = n(), .groups = "drop")

write.csv(df_evtrends, "trends_ev.csv")

linechart_evtrends <- ggplot(df_evtrends, aes(x = Model.Year, y = Count, color = Electric.Vehicle.Type)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(title = "PHEV vs. BEV Trends By Year\nBEV Boost Widens Gap vs. PHEV") +
  scale_color_manual(values = c("Battery Electric Vehicle (BEV)" = "#E82127", "Plug-in Hybrid Electric Vehicle (PHEV)" = "#999999")) +
  theme_minimal()
linechart_evtrends

```

### Top 5 Utilities for Tesla

```{r Bar Chart Top 5 Utilities}
dftesla_utilities <- dfclnfil %>%
  filter(Tesla.Vs.Others == "TESLA") %>%
  group_by(Electric.Utility) %>%
  summarise(Count = n(), .groups = "drop") %>%
  arrange(desc(Count))

dftesla_top5 <- head(dftesla_utilities, 5)

library(stringr)
dftesla_top5$Electric.Utility <- str_wrap(dftesla_top5$Electric.Utility, width = 25)


barchart_utilities <- ggplot(dftesla_top5, aes(x = reorder(Electric.Utility, Count), y = Count)) + 
  geom_col(fill = "#af2529") +
  coord_flip() +
  labs(title = "Top 5 Utilities for Tesla\nPuget and Tesla Partnership Evident", x = NULL, y = "Tesla Count")+
  theme_minimal() +
  theme(
    axis.text.y = element_text(size = 10),
    axis.text.x = element_text(size = 10),
    plot.title = element_text(size = 14, face = "bold")
  )
barchart_utilities
```

### About This Project

Built using R and Flexdashboard, this project demonstrates data wrangling, enrichment with MSRP reference data, and business-focused visualization. All code and data sources are documented for reproducibility.
