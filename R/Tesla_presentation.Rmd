---
title: "Washington EV Market Breakdown: Tesla’s Share, Pricing, and Trends"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: scroll
    theme: cosmo
    toc: true
---

### Executive Summary

```         
This dashboard analyzes Tesla’s performance in Washington State’s electric vehicle market
using real-world registration data and researched MSRP values plus researched electric range values.

This was because 99% of the price and range values for the Washington dataset were missing.
(https://catalog.data.gov/dataset/electric-vehicle-population-data). 
To address this, I conducted manual and batch research to enrich the dataset 
with accurate MSRP values and range values.  
This made the analysis more valid vs. just filtering out the 1% of data that were available. 
This proactive effort step resulted in more realistic revenue estimation and competitive analysis.

**Key questions addressed:**

- What is Tesla’s market share in WA compared to other EV brands?
- How is Tesla's market share trending over time?
- Which Tesla models are most popular, and what is their estimated revenue impact?
- How is Tesla's revenue trending over time?
- How do Tesla’s vehicle ranges and prices compare to competitors?
- How are PHEV and BEV trending?
- Which utilities are most commonly associated with Tesla EV registrations?

This project moves beyond the core descriptive metrics and gives deeper insights
about the market.


```


### Electric Vehicles All Time Market Share in WA (By Number of Cars Registered)

```{r Market Share Donut Chart}
library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)
library(scales)

dfcln <- read.csv("C:/Users/sandy/zportfolio_projects_128gbsdcard/2025_grouped/electric_vehicles/data_csv_files/df.csv")


dfwa <- dfcln %>% filter(State == "WA")

dfwa <- dfwa %>% mutate(Tesla.Vs.Others = case_when(
  Make == "TESLA" ~ "TESLA",
  TRUE ~ "OTHERS")
)

tesladf <- dfwa %>% filter(Make == "TESLA")
tesla_market_share <- nrow(tesladf) / nrow(dfwa) * 100
tesla_market_share <- round(tesla_market_share, digits = 1)


holesize <- 2
dfmarket<- data.frame(
  Group = c("Tesla", "Other"),
  Market_Share = c(tesla_market_share, 100-tesla_market_share)) %>%
  mutate(x = holesize)


donut_chart <- ggplot(dfmarket, aes(x = x, y = Market_Share, fill = Group)) +
  geom_col(width = 1, color = "white") +
  coord_polar(theta = "y") +
  xlim(c(0.2, holesize +0.5 )) +
  theme_void() +
  labs(title = "Tesla In A Good Position with 43% Market Share in WA",
  subtitle = "Count of Electric Vehicles in WA - All Time")+
  geom_text(aes(label = paste0(Market_Share, "%")), position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Tesla" = "#E82127", "Other" = "#999999"))

donut_chart

ggsave("1.donut_chart.png", donut_chart, bg = "white")


```

### Stacked bar plot of market share by year

```{r Stacked bar Market shares}
# Create new df_shr_yrs, Tesla vs. Others
df_shr_yrs <- dfwa %>%
  group_by(Model.Year, Tesla.Vs.Others) %>%
  summarize(count=n(), 
  .groups = "drop") %>%
  arrange(Model.Year)

barchart_marketshares_year <- ggplot(
  df_shr_yrs %>% filter(Model.Year > 2010),
  aes(x = Model.Year, y = count, fill = Tesla.Vs.Others)) +
  geom_col() +
  scale_fill_manual(values = c("TESLA" = "#E82127", "OTHERS" = "#999999")) +
  labs(title = "Tesla Maintaining Shares Especially Past 3 Years", x = NULL, y = "Count of Registered Vehicles") +
  theme_minimal() +
  theme(
    panel.grid = element_blank()
  )
barchart_marketshares_year
ggsave("2. barchart_marketshares.png", barchart_marketshares_year, bg = "white")

```


### Top Tesla Models Sold - All Time

```{r Bar Chart Top Tesla Models Sold}

teslatop <- tesladf %>% group_by(Make, Model) %>% summarize(count = n(), .groups = "drop") %>% arrange(desc(count))

barchart_topmodels <- ggplot(teslatop, aes(x=reorder(Model, count), y = count)) +
  geom_col(fill = "#E82127") +
  coord_flip() +
  labs(title = "Model Y and Model 3 Dominate",
  subtitle = "Tesla Models Sold - All Time", 
  x = NULL) +
  theme_minimal()

barchart_topmodels

ggsave("3.barchart_topmodels.png", barchart_topmodels, bg = "white")
```

### Top Tesla Models Estimated Revenue (All Time)

```{r Bar Chart Top Models Estimated Revenue}

msrp_lookup <- data.frame(
  Make = c("TESLA", "TESLA", "TESLA", "TESLA", "TESLA", "TESLA"),
  Model    = c("MODEL Y", "MODEL 3", "MODEL S", "MODEL X", "CYBERTRUCK", "ROADSTER"),
  AvgMSRP = c(50810, 48740, 87490, 92490, 84990, 225000),
  MinMSRP  = c(46630, 42490, 79990, 84990, 69990, 200000),
  MaxMSRP  = c(54990, 54990, 94990, 99990, 99990, 250000),
  stringsAsFactors = FALSE
)

teslatopwprice <- teslatop %>%
  left_join(msrp_lookup, by = "Model")

teslatopwprice <- teslatopwprice %>%
  mutate(
    AvgRevenue = count * AvgMSRP,
    MinRevenue = count * MinMSRP,
    MaxRevenue = count * MaxMSRP
  )


barchart_topmodels_avgrevenues <- ggplot(teslatopwprice, aes(x=reorder(Model, AvgRevenue), y = AvgRevenue)) +
  geom_col(fill = "#999999") +
  coord_flip() +
  labs(title = "Top Tesla Models (Counts) Reflect All Time Revenues", x = NULL, y = NULL) +
  scale_y_continuous(labels = label_comma()) +
  theme_minimal() +
  theme(
    panel.grid = element_blank()
  )
barchart_topmodels_avgrevenues

ggsave("4.barchart_topmodels_avgrevenues.png", barchart_topmodels_avgrevenues, bg = "white")
```

### Tesla Electric Vehicles Sold By Year (As of mid July 2025)

```{r Line Chart Tesla Sales By Year}
df_tesla_sold_by_year <- dfwa %>%
  filter(Tesla.Vs.Others == "TESLA") %>%
  group_by(Model.Year) %>%
  summarise(Count = n()) %>%
  arrange(Model.Year)


linechart_tesla_by_year <- ggplot(df_tesla_sold_by_year, aes(x = Model.Year, y = Count)) +
  geom_line(color = "#999999", size = 1) +
  geom_point(color = "#E82127", size = 2) +
  labs(title = "2023 Unusual Spike in Tesla Vehicles Sold By Year",
  subtitle = "Due to New Tax credits in 2023", y = NULL) +
  theme_minimal() +
  theme(
    panel.grid = element_blank()
  )
linechart_tesla_by_year

ggsave("5.linechart_tesla_by_year.png", linechart_tesla_by_year, bg = "white")

```

### Tesla Vehicle Forecast for 2025 (As of midJuly 2025)

```{r ARIMA forecast for Tesla linechart}


library(conflicted)
conflicts_prefer(dplyr::filter)


dfcln <- read.csv("dfcln.csv")
dfwa <- dfcln %>% filter(State == "WA")
dfwa <- dfwa %>% mutate(Tesla.Vs.Others = case_when(
  Make == "TESLA" ~ "TESLA",
  TRUE ~ "OTHERS")
)
write.csv(dfwa, "dfwa.csv") 


df_tesla_sold_by_year <- dfwa %>%
  filter(Tesla.Vs.Others == "TESLA") %>%
  group_by(Model.Year) %>%
  summarise(Count = n()) %>%
  arrange(Model.Year)
write.csv(df_tesla_sold_by_year, "df_tesla_sold_by_year.csv")


newvalue2023 = mean(df_tesla_sold_by_year$Count[df_tesla_sold_by_year$Model.Year %in% c(2022, 2024)])
df_tesla_tempered <- df_tesla_sold_by_year %>%
  mutate(Count = ifelse(Model.Year == 2023, newvalue2023, Count)) %>%
  filter(Model.Year >= 2010) %>%
  filter(Model.Year != 2025)
write.csv(df_tesla_tempered, "df_tesla_tempered.csv")



library(forecast)
library(scales) 


ts_tesla <- ts(df_tesla_tempered$Count,
               start = min(df_tesla_tempered$Model.Year),
               frequency = 1)


fit_tesla <- auto.arima(ts_tesla)


forecast_arima <- forecast(fit_tesla, h = 1)
save(forecast_arima, file = "forecast_arima.Rdata")




point_2025 <- round(forecast_arima$mean[1], 0)
lo95_2025  <- round(forecast_arima$lower[1, 2], 0)  
hi95_2025  <- round(forecast_arima$upper[1, 2], 0) 



linechart_tesla_by_year_forecast <- autoplot(forecast_arima) +
  geom_point(aes(x = 2025, y = forecast_arima$mean[1]),
             color = "red", size = 3) +
  geom_text(aes(x = 2025, y = forecast_arima$mean[1],
                label = paste0("2025: ", round(forecast_arima$mean[1], 0))),
            vjust = -1, color = "red", size = 4) +
  scale_x_continuous(breaks = seq(2010, 2025, 1)) +  
  scale_y_continuous(labels = comma) +               
  labs(
  title = "Tesla Forecast For 2025 is 18k+ vs. 17k+ in 2024",
  subtitle = "2023 Spike Is Tempered. Based On Yearly Trends\nAssuming No Surge After June Or Major Policy Changes",
  x = "Model Year",
  y = "Tesla"
) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0),
    plot.subtitle = element_text(hjust = 0),
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major = element_blank(),  
    panel.grid.minor = element_blank(),  
    panel.border = element_blank(),      
    axis.ticks = element_line(color = "black")  
  )

linechart_tesla_by_year_forecast

ggsave("6.forecast_tesla.png", linechart_tesla_by_year_forecast, bg = "white")

```


### Average Prices for Battery Electric Vehicles

```{r  Bar Chart MSRP for BEV}
msrp_csv <- read_delim(
  "C:/Users/sandy/zportfolio_projects_128gbsdcard/2025_grouped/electric_vehicles/data_csv_files/msrp_compiled.csv",
  delim = "|",
  escape_double = FALSE,
  trim_ws = TRUE
)

msrp_csv <- msrp_csv %>%
  slice(-1) %>%
  select(Make, Model, MinMSRP, MaxMSRP, `Price Year`) %>%
  mutate(
    MinMSRP = as.numeric(MinMSRP),
    MaxMSRP = as.numeric(MaxMSRP),
    AvgMSRP = round((MinMSRP + MaxMSRP) / 2, 0)
  )
         
dfclnfil <- inner_join(dfwa, msrp_csv, by = c("Make", "Model"))

dfteslavothers <- dfclnfil %>% group_by(Tesla.Vs.Others) %>%
 summarise(AvgMSRP = mean(AvgMSRP), MedianMSRP = median(AvgMSRP))

barchart_msrps <- ggplot(dfteslavothers, aes(x = Tesla.Vs.Others, y = AvgMSRP, fill = Tesla.Vs.Others)) +
  geom_col() +
  scale_fill_manual(values = c("TESLA" = "#E82127", "OTHERS" = "#999999")) +
  labs(title = "Average of Prices for Tesla Models Seems Only Slightly Higher ",
  subtitle = "Vs. Other Battery Vehicles, Researched Prices Used Beyond Dataset", 
  x = NULL, y = "Average Prices USD") +
  theme_minimal() +
  theme(
    panel.grid = element_blank()
  )
barchart_msrps

ggsave("7. barchart_msrps.png", barchart_msrps, bg = "white")
```


### Under $100K Segment - Prices By Manufacturer


```{r Non-luxury prices}

msrp_csv <- read.csv("C:/Users/sandy/zportfolio_projects_128gbsdcard/2025_grouped/electric_vehicles/data_csv_files/msrp_csv.csv")

msrp_nonlux <- msrp_csv %>% filter(AvgMSRP < 100000)
write.csv(msrp_nonlux, "msrp_nonlux.csv")



all_makes <- unique(msrp_nonlux$Make)

my_colors <- ifelse(all_makes == "TESLA", "#E82127", "#999999")
names(my_colors) <- all_makes


 
boxplot_msrp_nonlux <- ggplot(msrp_nonlux, aes(x = reorder(Make, AvgMSRP, FUN = median), y = AvgMSRP)) +
  geom_boxplot(aes(fill = Make), outlier.shape = 20, colour = "lightgrey") + 
  coord_flip() + 
  scale_fill_manual(values = my_colors) + 
  scale_y_continuous(labels = scales::dollar_format()) + 
  labs(
    title = "Deep Dive Shows Tesla Models Have Higher Average Prices",
    subtitle = "Based On Researched Prices Beyond Dataset\nWithin the Under $100k Segment",
    y = "Average MSRP (USD)",
    x = "Car Make"
  ) +
  theme_minimal() +
  theme(
    axis.title = element_text(size = 14),
    axis.text.y = element_text(size = 9),
    axis.text.x = element_text(size = 9),
    legend.position = "none",
    panel.grid = element_blank()
  )

boxplot_msrp_nonlux
ggsave("8. boxplot_msrp_nonluxury.png", boxplot_msrp_nonlux, bg = "white")

```

### Average Ranges for Battery Electric Vehicles

```{r Bar Chart Ranges for BEV}

dfevs <- dfclnfil %>% filter(Electric.Vehicle.Type == "Battery Electric Vehicle (BEV)" & Electric.Range != 0)
dfevsranges <- dfevs %>% group_by(Tesla.Vs.Others) %>%
  summarise(AvgRange = mean(Electric.Range), MedianRange= median(Electric.Range))


write.csv(dfevsranges, "tesla_others_ranges.csv")

barchart_ranges <- ggplot(dfevsranges, aes(x = Tesla.Vs.Others, y = AvgRange, fill = Tesla.Vs.Others)) +
  geom_col() +
  scale_fill_manual(values = c("TESLA" = "#E82127", "OTHERS" = "#999999")) +
  labs(title = "Tesla Has About 100 Miles Higher Range vs. Others",
  subtitle = "Among Battery Electric Vehicles", 
  x = NULL, 
  y = "Average Range (miles)") +
  theme_minimal() +
  theme(
    panel.grid = element_blank()
  )

barchart_ranges
ggsave("9. barchart_ranges.png", barchart_ranges, bg = "white")

```

### Battery Electric Vehicle Segment Ranges
```{r Boxplot of Ranges}

dfbev_boxplot<- read.csv("C:/Users/sandy/zportfolio_projects_128gbsdcard/2025_grouped/electric_vehicles/data_csv_files/dfbev_joined_for_boxplot.csv", strip.white = TRUE)


all_makes <- unique(dfbev_boxplot$Make)

my_colors <- ifelse(all_makes == "TESLA", "#E82127", "#999999")
names(my_colors) <- all_makes

boxplot_ranges <- ggplot(dfbev_boxplot, aes(x = reorder(Make, Electric.Range, FUN = median), y = Electric.Range)) +
  geom_boxplot(aes(fill = Make), outlier.colour = "red", outlier.shape = 20, colour = "lightgrey") +
  coord_flip() + 
  scale_fill_manual(values = my_colors) + 
  labs(
    title = "Deep Dive Shows Tesla Models Have Higher Range",
    subtitle = "Average Electric Range in Miles by Make",
    y = "Average Electric Range (Miles)",
    x = "Car Make"
  ) +
  theme_minimal() +
  theme(
    axis.title = element_text(size = 14),
    axis.text.y = element_text(size = 9),
    axis.text.x = element_text(size = 9),
    legend.position = "none",
    panel.grid = element_blank()
  )
boxplot_ranges
ggsave("10. boxplot_ranges.png", boxplot_ranges, bg = "white")


```



### PHEV vs. BEV Trends By Year

```{r  PHEV vs BEV Trends By Year}
df_evtrends <- dfclnfil %>%
  group_by(Model.Year, Electric.Vehicle.Type)  %>%
  summarise(Count = n(), .groups = "drop")

write.csv(df_evtrends, "trends_ev.csv")

linechart_evtrends <- ggplot(df_evtrends, aes(x = Model.Year, y = Count, color = Electric.Vehicle.Type)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(title = "BEV (Battery) Boost Widens Gap vs. PHEV (Plug-in Hybrid)",
  subtitle = "2018: Battery Starts to Widen Gap") +
  scale_color_manual(values = c("Battery Electric Vehicle (BEV)" = "#E82127", "Plug-in Hybrid Electric Vehicle (PHEV)" = "#999999")) +
  theme_minimal() +
  theme(
    panel.grid = element_blank()
  )
linechart_evtrends

ggsave("11.linechart_evtrends.png", linechart_evtrends, bg = "white")

```

### Top 5 Utilities for Tesla

```{r Bar Chart Top 5 Utilities}
dftesla_utilities <- dfclnfil %>%
  filter(Tesla.Vs.Others == "TESLA") %>%
  group_by(Electric.Utility) %>%
  summarise(Count = n(), .groups = "drop") %>%
  arrange(desc(Count))

dftesla_top5 <- head(dftesla_utilities, 5)

library(stringr)
dftesla_top5$Electric.Utility <- str_wrap(dftesla_top5$Electric.Utility, width = 25)


barchart_utilities <- ggplot(dftesla_top5, aes(x = reorder(Electric.Utility, Count), y = Count)) + 
  geom_col(fill = "#af2529") +
  coord_flip() +
  labs(title = "Puget and Tesla Partnership Evident\nIn the Top 5 Utilities for Tesla", 
       x = NULL, 
       y = "Tesla Count")+
  theme_minimal() +
  theme(
    axis.text.y = element_text(size = 10),
    axis.text.x = element_text(size = 10),
    plot.title = element_text(size = 12),
    panel.grid = element_blank()
  )
barchart_utilities


ggsave("12. barchart_top5_utilities.png", barchart_utilities, bg = "white")

```

### About This Project

This dashboard was built in R using Flexdashboard. It walks through how raw registration data was cleaned, enriched with MSRP and electric range data based on research, and visualized with business impact in mind. Every step — from wrangling to final chart — is documented and reproducible.
